"use strict";(self.webpackChunkcumulocity_processing_widget_plugin=self.webpackChunkcumulocity_processing_widget_plugin||[]).push([[25803,13291],{25803:function(e,t,n){var i;n.r(t),n.d(t,{BsComponentRef:function(){return c},ComponentLoader:function(){return _},ComponentLoaderFactory:function(){return p},ContentRef:function(){return a}});var o=n(40761),s=n(38310),r=n(88553),h=n(80179);class c{}class a{constructor(e,t,n){this.nodes=e,this.viewRef=t,this.componentRef=n}}class _{constructor(e,t,n,i,s,r,h,c,a){this._viewContainerRef=e,this._renderer=t,this._elementRef=n,this._injector=i,this._componentFactoryResolver=s,this._ngZone=r,this._applicationRef=h,this._posService=c,this._document=a,this.onBeforeShow=new o.EventEmitter,this.onShown=new o.EventEmitter,this.onBeforeHide=new o.EventEmitter,this.onHidden=new o.EventEmitter,this._providers=[],this._isHiding=!1,this.containerDefaultSelector="body",this._listenOpts={},this._globalListener=Function.prototype}get isShown(){return!this._isHiding&&!!this._componentRef}attach(e){return this._componentFactory=this._componentFactoryResolver.resolveComponentFactory(e),this}to(e){return this.container=e||this.container,this}position(e){return e?(this.attachment=e.attachment||this.attachment,this._elementRef=e.target||this._elementRef,this):this}provide(e){return this._providers.push(e),this}show(e={}){if(this._subscribePositioning(),this._innerComponent=void 0,!this._componentRef){this.onBeforeShow.emit(),this._contentRef=this._getContentRef(e.content,e.context,e.initialState);const t=o.Injector.create({providers:this._providers,parent:this._injector});if(!this._componentFactory)return;if(this._componentRef=this._componentFactory.create(t,this._contentRef.nodes),this._applicationRef.attachView(this._componentRef.hostView),this.instance=this._componentRef.instance,Object.assign(this._componentRef.instance,e),this.container instanceof o.ElementRef&&this.container.nativeElement.appendChild(this._componentRef.location.nativeElement),"string"==typeof this.container&&void 0!==this._document){const e=this._document.querySelector(this.container)||this._document.querySelector(this.containerDefaultSelector);if(!e)return;e.appendChild(this._componentRef.location.nativeElement)}!this.container&&this._elementRef&&this._elementRef.nativeElement.parentElement&&this._elementRef.nativeElement.parentElement.appendChild(this._componentRef.location.nativeElement),this._contentRef.componentRef&&(this._innerComponent=this._contentRef.componentRef.instance,this._contentRef.componentRef.changeDetectorRef.markForCheck(),this._contentRef.componentRef.changeDetectorRef.detectChanges()),this._componentRef.changeDetectorRef.markForCheck(),this._componentRef.changeDetectorRef.detectChanges(),this.onShown.emit(e.id?{id:e.id}:this._componentRef.instance)}return this._registerOutsideClick(),this._componentRef}hide(e){if(!this._componentRef)return this;this._posService.deletePositionElement(this._componentRef.location),this.onBeforeHide.emit(this._componentRef.instance);const t=this._componentRef.location.nativeElement;return t.parentNode?.removeChild(t),this._contentRef?.componentRef?.destroy(),this._viewContainerRef&&this._contentRef?.viewRef&&this._viewContainerRef.remove(this._viewContainerRef.indexOf(this._contentRef.viewRef)),this._contentRef?.viewRef?.destroy(),this._contentRef=void 0,this._componentRef=void 0,this._removeGlobalListener(),this.onHidden.emit(e?{id:e}:null),this}toggle(){this.isShown?this.hide():this.show()}dispose(){this.isShown&&this.hide(),this._unsubscribePositioning(),this._unregisterListenersFn&&this._unregisterListenersFn()}listen(e){this.triggers=e.triggers||this.triggers,this._listenOpts.outsideClick=e.outsideClick,this._listenOpts.outsideEsc=e.outsideEsc,e.target=e.target||this._elementRef?.nativeElement;const t=this._listenOpts.hide=()=>e.hide?e.hide():void this.hide(),n=this._listenOpts.show=t=>{e.show?e.show(t):this.show(t),t()},i=e=>{this.isShown?t():n(e)};return this._renderer&&(this._unregisterListenersFn=(0,s.listenToTriggersV2)(this._renderer,{target:e.target,triggers:e.triggers,show:n,hide:t,toggle:i})),this}_removeGlobalListener(){this._globalListener&&(this._globalListener(),this._globalListener=Function.prototype)}attachInline(e,t){return e&&t&&(this._inlineViewRef=e.createEmbeddedView(t)),this}_registerOutsideClick(){if(this._componentRef&&this._componentRef.location){if(this._listenOpts.outsideClick){const e=this._componentRef.location.nativeElement;setTimeout((()=>{this._renderer&&this._elementRef&&(this._globalListener=(0,s.registerOutsideClick)(this._renderer,{targets:[e,this._elementRef.nativeElement],outsideClick:this._listenOpts.outsideClick,hide:()=>this._listenOpts.hide&&this._listenOpts.hide()}))}))}if(this._listenOpts.outsideEsc&&this._renderer&&this._elementRef){const e=this._componentRef.location.nativeElement;this._globalListener=(0,s.registerEscClick)(this._renderer,{targets:[e,this._elementRef.nativeElement],outsideEsc:this._listenOpts.outsideEsc,hide:()=>this._listenOpts.hide&&this._listenOpts.hide()})}}}getInnerComponent(){return this._innerComponent}_subscribePositioning(){!this._zoneSubscription&&this.attachment&&(this.onShown.subscribe((()=>{this._posService.position({element:this._componentRef?.location,target:this._elementRef,attachment:this.attachment,appendToBody:"body"===this.container})})),this._zoneSubscription=this._ngZone.onStable.subscribe((()=>{this._componentRef&&this._posService.calcPosition()})))}_unsubscribePositioning(){this._zoneSubscription&&(this._zoneSubscription.unsubscribe(),this._zoneSubscription=void 0)}_getContentRef(e,t,n){if(!e)return new a([]);if(e instanceof o.TemplateRef){if(this._viewContainerRef){const n=this._viewContainerRef.createEmbeddedView(e,t);return n.markForCheck(),new a([n.rootNodes],n)}const n=e.createEmbeddedView({});return this._applicationRef.attachView(n),new a([n.rootNodes],n)}if("function"==typeof e){const t=this._componentFactoryResolver.resolveComponentFactory(e),i=o.Injector.create({providers:this._providers,parent:this._injector}),s=t.create(i);return Object.assign(s.instance,n),this._applicationRef.attachView(s.hostView),new a([[s.location.nativeElement]],s.hostView,s)}const i=this._renderer?[this._renderer.createText(`${e}`)]:[];return new a([i])}}class p{constructor(e,t,n,i,o,s){this._componentFactoryResolver=e,this._ngZone=t,this._injector=n,this._posService=i,this._applicationRef=o,this._document=s}createLoader(e,t,n){return new _(t,n,e,this._injector,this._componentFactoryResolver,this._ngZone,this._applicationRef,this._posService,this._document)}}p.ɵfac=o["ɵɵngDeclareFactory"]({minVersion:"12.0.0",version:"14.0.6",ngImport:i||(i=n.t(o,2)),type:p,deps:[{token:o.ComponentFactoryResolver},{token:o.NgZone},{token:o.Injector},{token:r.PositioningService},{token:o.ApplicationRef},{token:h.DOCUMENT}],target:o["ɵɵFactoryTarget"].Injectable}),p.ɵprov=o["ɵɵngDeclareInjectable"]({minVersion:"12.0.0",version:"14.0.6",ngImport:i||(i=n.t(o,2)),type:p,providedIn:"root"}),o["ɵɵngDeclareClassMetadata"]({minVersion:"12.0.0",version:"14.0.6",ngImport:i||(i=n.t(o,2)),type:p,decorators:[{type:o.Injectable,args:[{providedIn:"root"}]}],ctorParameters:function(){return[{type:o.ComponentFactoryResolver},{type:o.NgZone},{type:o.Injector},{type:r.PositioningService},{type:o.ApplicationRef},{type:Document,decorators:[{type:o.Inject,args:[h.DOCUMENT]}]}]}})}}]);