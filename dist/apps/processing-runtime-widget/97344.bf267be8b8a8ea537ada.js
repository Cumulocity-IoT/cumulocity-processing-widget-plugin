"use strict";(self.webpackChunkcumulocity_processing_widget_plugin=self.webpackChunkcumulocity_processing_widget_plugin||[]).push([[97344],{97344:function(e,t,n){n.r(t),n.d(t,{FORMLY_CONFIG:function(){return A},Field:function(){return z},FieldArrayType:function(){return Z},FieldType:function(){return Q},FieldWrapper:function(){return Y},FormlyAttributes:function(){return L},FormlyConfig:function(){return D},FormlyField:function(){return B},FormlyForm:function(){return q},FormlyFormBuilder:function(){return G},FormlyModule:function(){return ie},"ɵa":function(){return oe},"ɵb":function(){return J},"ɵc":function(){return U},"ɵclone":function(){return j},"ɵd":function(){return K},"ɵdefineHiddenProp":function(){return R},"ɵe":function(){return re},"ɵf":function(){return te},"ɵg":function(){return ne},"ɵgetFieldInitialValue":function(){return _},"ɵh":function(){return ee},"ɵreverseDeepMerge":function(){return O},"ɵwrapProperty":function(){return I}});var r=n(80179),o=n(40761),i=n(15813),s=n(76063),a=n(24219),l=n(89754),p=n(58156),u=["content"];function f(e,t){if(1&e&&o["ɵɵelement"](0,"formly-field",2),2&e){var n=t.$implicit;o["ɵɵproperty"]("form",n.form)("options",n.options)("model",n.model)("field",n)}}var c=["*"],d=["container"];function h(e,t){}var m=["fieldComponent"];function y(e,t){if(1&e&&o["ɵɵelement"](0,"formly-field",1),2&e){var n=t.$implicit;o["ɵɵproperty"]("field",n)}}function g(e,t,n){if(t.id)return t.id;var r=t.type;return!r&&t.template&&(r="template"),[e,r,t.key,n].join("_")}function v(e){if(!e.key)return[];if(!e._keyPath||e._keyPath.key!==e.key){var t=[];if("string"==typeof e.key){var n=-1===e.key.indexOf("[")?e.key:e.key.replace(/\[(\w+)\]/g,".$1");t=-1!==n.indexOf(".")?n.split("."):[n]}else t=Array.isArray(e.key)?e.key.slice(0):[""+e.key];e._keyPath={key:e.key,path:t}}return e._keyPath.path.slice(0)}var b=["required","pattern","minLength","maxLength","min","max"];function C(e,t){var n=v(e);if(0!==n.length){for(var r=e;r.parent;)r=r.parent,n=(0,p.__spread)(v(r),n);if(void 0===t&&e.resetOnHide){var o=n.pop();delete n.reduce((function(e,t){return e[t]||{}}),r.model)[o]}else!function(e,t,n){for(var r=0;r<t.length-1;r++){var o=t[r];e[o]&&P(e[o])||(e[o]=/^\d+$/.test(t[r+1])?[]:{}),e=e[o]}e[t[t.length-1]]=j(n)}(r.model,n,t)}}function _(e){for(var t,n,r=e.options._initialModel,o=v(e);e.parent;)e=e.parent,o=(0,p.__spread)(v(e),o);try{for(var i=(0,p.__values)(o),s=i.next();!s.done;s=i.next()){var a=s.value;if(!r)return;r=r[a]}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}function F(e){var t,n,r=e.parent.model;try{for(var o=(0,p.__values)(v(e)),i=o.next();!i.done;i=o.next()){var s=i.value;if(!r)return r;r=r[s]}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r}function O(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.forEach((function(t){for(var n in t)E(e[n])||x(e[n])?e[n]=j(t[n]):V(e[n],t[n])&&O(e[n],t[n])})),e}function E(e){return null==e}function k(e){return void 0===e}function x(e){return""===e}function w(e){return"function"==typeof e}function V(e,t){return P(e)&&P(t)&&Object.getPrototypeOf(e)===Object.getPrototypeOf(t)&&!(Array.isArray(e)||Array.isArray(t))}function P(e){return null!=e&&"object"==typeof e}function j(e){if(!P(e)||(0,l.isObservable)(e)||e.changingThisBreaksApplicationSecurity||-1!==["RegExp","FileList","File","Blob"].indexOf(e.constructor.name))return e;if(e._isAMomentObject&&w(e.clone))return e.clone();if(e instanceof a.AbstractControl)return null;if(e instanceof Date)return new Date(e.getTime());if(Array.isArray(e))return e.slice(0).map((function(e){return j(e)}));var t=Object.getPrototypeOf(e),n=Object.create(t);return n=Object.setPrototypeOf(n,t),Object.keys(e).reduce((function(t,n){var r=Object.getOwnPropertyDescriptor(e,n);return r.get?Object.defineProperty(t,n,r):t[n]=j(e[n]),t}),n)}function R(e,t,n){Object.defineProperty(e,t,{enumerable:!1,writable:!0,configurable:!0}),e[t]=n}function I(e,t,n){e._observers||R(e,"_observers",{}),e._observers[t]||(e._observers[t]=[]);var r=e._observers[t];return-1===r.indexOf(n)&&(r.push(n),n({currentValue:e[t],firstChange:!0}),1===r.length&&(R(e,"___$"+t,e[t]),Object.defineProperty(e,t,{configurable:!0,get:function(){return e["___$"+t]},set:function(n){if(n!==e["___$"+t]){var o=e["___$"+t];e["___$"+t]=n,r.forEach((function(e){return e({previousValue:o,currentValue:n,firstChange:!1})}))}}}))),function(){return r.splice(r.indexOf(n),1)}}function M(e,t){var n=e._updateTreeValidity.bind(e),r={called:!1,emitEvent:!1};e._updateTreeValidity=function(e){var t=(void 0===e?{emitEvent:!0}:e).emitEvent;return r={called:!0,emitEvent:t||r.emitEvent}},t(),r.called&&n({emitEvent:r.emitEvent}),e._updateTreeValidity=n}var A=new o.InjectionToken("FORMLY_CONFIG"),D=function(){function e(){this.types={},this.validators={},this.wrappers={},this.messages={},this.templateManipulators={preWrapper:[],postWrapper:[]},this.extras={checkExpressionOn:"changeDetectionCheck",lazyRender:!1,showError:function(e){return e.formControl&&e.formControl.invalid&&(e.formControl.touched||e.options.parentForm&&e.options.parentForm.submitted||!(!e.field.validation||!e.field.validation.show))}},this.extensions={}}return e.prototype.addConfig=function(e){var t=this;e.types&&e.types.forEach((function(e){return t.setType(e)})),e.validators&&e.validators.forEach((function(e){return t.setValidator(e)})),e.wrappers&&e.wrappers.forEach((function(e){return t.setWrapper(e)})),e.manipulators&&(console.warn("NgxFormly: passing 'manipulators' config is deprecated, use custom extension instead."),e.manipulators.forEach((function(e){return t.setManipulator(e)}))),e.validationMessages&&e.validationMessages.forEach((function(e){return t.addValidatorMessage(e.name,e.message)})),e.extensions&&e.extensions.forEach((function(e){return t.extensions[e.name]=e.extension})),e.extras&&(this.extras=(0,p.__assign)({},this.extras,e.extras))},e.prototype.setType=function(e){var t=this;Array.isArray(e)?e.forEach((function(e){return t.setType(e)})):(this.types[e.name]||(this.types[e.name]={name:e.name}),["component","extends","defaultOptions","wrappers"].forEach((function(n){e.hasOwnProperty(n)&&(t.types[e.name][n]=e[n])})))},e.prototype.getType=function(e){if(!this.types[e])throw new Error('[Formly Error] The type "'+e+'" could not be found. Please make sure that is registered through the FormlyModule declaration.');return this.mergeExtendedType(e),this.types[e]},e.prototype.getMergedField=function(e){var t=this;void 0===e&&(e={});var n=this.getType(e.type);n.defaultOptions&&O(e,n.defaultOptions);var r=n.extends&&this.getType(n.extends).defaultOptions;r&&O(e,r),e&&e.optionsTypes&&e.optionsTypes.forEach((function(n){var r=t.getType(n).defaultOptions;r&&O(e,r)}));var o=this.resolveFieldTypeRef(e);o&&o.instance&&o.instance.defaultOptions&&O(e,o.instance.defaultOptions),!e.wrappers&&n.wrappers&&(e.wrappers=(0,p.__spread)(n.wrappers))},e.prototype.resolveFieldTypeRef=function(e){if(void 0===e&&(e={}),!e.type)return null;var t=this.getType(e.type);if(!t.component||t._componentRef)return t._componentRef;var n=e.parent.options,r=n._resolver,o=n._injector,i=r.resolveComponentFactory(t.component).create(o);return R(t,"_componentRef",i),i.destroy(),t._componentRef},e.prototype.setWrapper=function(e){var t=this;this.wrappers[e.name]=e,e.types&&e.types.forEach((function(n){t.setTypeWrapper(n,e.name)}))},e.prototype.getWrapper=function(e){if(!this.wrappers[e])throw new Error('[Formly Error] The wrapper "'+e+'" could not be found. Please make sure that is registered through the FormlyModule declaration.');return this.wrappers[e]},e.prototype.setTypeWrapper=function(e,t){this.types[e]||(this.types[e]={}),this.types[e].wrappers||(this.types[e].wrappers=[]),-1===this.types[e].wrappers.indexOf(t)&&this.types[e].wrappers.push(t)},e.prototype.setValidator=function(e){this.validators[e.name]=e},e.prototype.getValidator=function(e){if(!this.validators[e])throw new Error('[Formly Error] The validator "'+e+'" could not be found. Please make sure that is registered through the FormlyModule declaration.');return this.validators[e]},e.prototype.addValidatorMessage=function(e,t){this.messages[e]=t},e.prototype.getValidatorMessage=function(e){return this.messages[e]},e.prototype.setManipulator=function(e){(new e.class)[e.method](this)},e.prototype.mergeExtendedType=function(e){if(this.types[e].extends){var t=this.getType(this.types[e].extends);this.types[e].component||(this.types[e].component=t.component),this.types[e].wrappers||(this.types[e].wrappers=t.wrappers)}},e.ngInjectableDef=(0,o.defineInjectable)({factory:function(){return new e},token:e,providedIn:"root"}),e.ɵfac=function(t){return new(t||e)},e.ɵprov=o["ɵɵdefineInjectable"]({token:e,factory:function(t){return e.ɵfac(t)},providedIn:"root"}),("undefined"==typeof ngDevMode||ngDevMode)&&o["ɵsetClassMetadata"](e,[{type:o.Injectable,args:[{providedIn:"root"}]}],(function(){return[]}),null),e}(),G=function(){function e(e,t,n){this.formlyConfig=e,this.componentFactoryResolver=t,this.injector=n}return e.prototype.buildForm=function(e,t,n,r){var o=this;if(void 0===t&&(t=[]),!this.formlyConfig.extensions.core)throw new Error("NgxFormly: missing `forRoot()` call. use `forRoot()` when registering the `FormlyModule`.");var i={fieldGroup:t,model:n,formControl:e,options:this._setOptions(r)};M(e,(function(){return o._buildForm(i)})),i.options._checkField(i,!0)},e.prototype._buildForm=function(e){var t=this;this.getExtensions().forEach((function(t){return t.prePopulate&&t.prePopulate(e)})),this.getExtensions().forEach((function(t){return t.onPopulate&&t.onPopulate(e)})),e.fieldGroup&&e.fieldGroup.forEach((function(e){return t._buildForm(e)})),this.getExtensions().forEach((function(t){return t.postPopulate&&t.postPopulate(e)}))},e.prototype.getExtensions=function(){var e=this;return Object.keys(this.formlyConfig.extensions).map((function(t){return e.formlyConfig.extensions[t]}))},e.prototype._setOptions=function(e){var t=this;return(e=e||{}).formState=e.formState||{},e.showError||(e.showError=this.formlyConfig.extras.showError),e.fieldChanges||R(e,"fieldChanges",new l.Subject),e._resolver||R(e,"_resolver",this.componentFactoryResolver),e._injector||R(e,"_injector",this.injector),e._hiddenFieldsForCheck||(e._hiddenFieldsForCheck=[]),e._markForCheck||(e._markForCheck=function(t){t._componentRefs&&t._componentRefs.forEach((function(e){e.injector.get(o.ChangeDetectorRef).markForCheck()})),t.fieldGroup&&t.fieldGroup.forEach((function(t){return e._markForCheck(t)}))}),e._buildField||(e._buildField=function(e){return t.buildForm(e.form,e.fieldGroup,e.model,e.options),e}),e},e.ctorParameters=function(){return[{type:D},{type:o.ComponentFactoryResolver},{type:o.Injector}]},e.ngInjectableDef=(0,o.defineInjectable)({factory:function(){return new e((0,o.inject)(D),(0,o.inject)(o.ComponentFactoryResolver),(0,o.inject)(o.INJECTOR))},token:e,providedIn:"root"}),e.ɵfac=function(t){return new(t||e)(o["ɵɵinject"](D),o["ɵɵinject"](o.ComponentFactoryResolver),o["ɵɵinject"](o.Injector))},e.ɵprov=o["ɵɵdefineInjectable"]({token:e,factory:function(t){return e.ɵfac(t)},providedIn:"root"}),("undefined"==typeof ngDevMode||ngDevMode)&&o["ɵsetClassMetadata"](e,[{type:o.Injectable,args:[{providedIn:"root"}]}],(function(){return[{type:D},{type:o.ComponentFactoryResolver},{type:o.Injector}]}),null),e}();function N(e,t){void 0===t&&(t=!1);var n=e.formControl.parent;if(n){var r=e.formControl,o={emitEvent:t};if(n instanceof a.FormArray){var i=n.controls.findIndex((function(e){return e===r}));-1!==i&&$(n,o,(function(){return n.removeAt(i)}))}else if(n instanceof a.FormGroup){var s=v(e),l=s[s.length-1];n.get([l])===r&&$(n,o,(function(){return n.removeControl(l)}))}r.setParent(null)}}function T(e){if(e.formControl)return e.formControl;if(!1===e.shareFormControl)return null;var t=e.parent.formControl;return t?t.get(v(e)):null}function S(e,t,n){void 0===n&&(n=!1),(t=t||e.formControl)._fields||R(t,"_fields",[]),-1===t._fields.indexOf(e)&&t._fields.push(e),!e.formControl&&t&&(R(e,"formControl",t),e.templateOptions.disabled=!!e.templateOptions.disabled,I(e.templateOptions,"disabled",(function(t){var n=t.firstChange,r=t.currentValue;n||(r?e.formControl.disable():e.formControl.enable())})),t.registerOnDisabledChange&&t.registerOnDisabledChange((function(t){e.templateOptions.___$disabled=t,e.options&&e.options._markForCheck(e)})));var r=e.parent.formControl;if(r&&e.key){var o=v(e),i=F(e);E(t.value)&&E(i)||t.value===i||!(t instanceof a.FormControl)||t.patchValue(i);for(var s=function(e){var t=o[e];r.get([t])||$(r,{emitEvent:n},(function(){return r.setControl(t,new a.FormGroup({}))})),r=r.get([t])},l=0;l<o.length-1;l++)s(l);var p=o[o.length-1];e._hide||r.get([p])===t||$(r,{emitEvent:n},(function(){return r.setControl(p,t)}))}}function H(e){var t=e.status;e.updateValueAndValidity({emitEvent:!1}),t!==e.status&&e.statusChanges.emit(e.status)}function $(e,t,n){e instanceof a.FormGroup&&!e.__patchForEachChild&&(R(e,"__patchForEachChild",!0),e._forEachChild=function(t){Object.keys(e.controls).forEach((function(n){return e.controls[n]&&t(e.controls[n],n)}))});var r=e.updateValueAndValidity.bind(e);!1===t.emitEvent&&(e.updateValueAndValidity=function(e){r((0,p.__assign)({},e||{},{emitEvent:!1}))}),n(),!1===t.emitEvent&&(e.updateValueAndValidity=r)}function W(e){e._fields&&delete e._fields,e.setValidators(null),e.setAsyncValidators(null),(e instanceof a.FormGroup||e instanceof a.FormArray)&&Object.keys(e.controls).forEach((function(t){return W(e.controls[t])}))}var q=function(){function e(e,t,n,r,i){var a=this;this.formlyBuilder=e,this.formlyConfig=t,this.ngZone=n,this.parentFormGroup=i,this.modelChange=new o.EventEmitter,this.immutable=!1,this._modelChangeValue={},this.modelChangeSubs=[],this.modelChange$=new l.Subject,this.modelChangeSub=this.modelChange$.pipe((0,s.switchMap)((function(){return a.ngZone.onStable.asObservable().pipe((0,s.take)(1))}))).subscribe((function(){return a.ngZone.runGuarded((function(){a.checkExpressionChange(),a.modelChange.emit(a._modelChangeValue=j(a.model))}))})),null!==r&&console.warn("NgxFormly: passing 'immutable' attribute to 'formly-form' component is deprecated since v5.5, enable immutable mode through NgModule declaration instead."),this.immutable=null!==r||!!t.extras.immutable}return Object.defineProperty(e.prototype,"model",{get:function(){return this._model||(this._model={}),this._model},set:function(e){this._model=this.immutable?j(e):e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fields",{get:function(){return this._fields||[]},set:function(e){this._fields=this.immutable?j(e):e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this._options},set:function(e){this._options=this.immutable?j(e):e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"content",{set:function(e){e&&e.nativeElement.nextSibling&&console.warn("NgxFormly: content projection for 'formly-form' component is deprecated since v5.5, you should avoid passing content inside the 'formly-form' tag.")},enumerable:!0,configurable:!0}),e.prototype.ngDoCheck=function(){"changeDetectionCheck"===this.formlyConfig.extras.checkExpressionOn&&this.checkExpressionChange()},e.prototype.ngOnChanges=function(e){e.model&&this.field&&(this.field.model=this.model),e.fields&&this.form&&W(this.form),(e.fields||e.form||e.model&&this._modelChangeValue!==e.model.currentValue)&&(this.form=this.form||new a.FormGroup({}),this.setOptions(),this.options.updateInitialValue(),this.clearModelSubscriptions(),this.formlyBuilder.buildForm(this.form,this.fields,this.model,this.options),this.trackModelChanges(this.fields))},e.prototype.ngOnDestroy=function(){this.modelChangeSub.unsubscribe(),this.clearModelSubscriptions()},e.prototype.changeModel=function(e){e.key;var t=e.value;C(e.field,t),this.modelChange$.next()},e.prototype.setOptions=function(){var e=this;this.options||(this.options={}),this.options.resetModel||(this.options.resetModel=function(t){t=j(E(t)?e.options._initialModel:t),e.model&&(Object.keys(e.model).forEach((function(t){return delete e.model[t]})),Object.assign(e.model,t||{})),e.options._buildForm(),e.options.parentForm&&e.options.parentForm.control===e.form?e.options.parentForm.resetForm(e.model):e.form.reset(e.model)}),!this.options.parentForm&&this.parentFormGroup&&(R(this.options,"parentForm",this.parentFormGroup),I(this.options.parentForm,"submitted",(function(t){t.firstChange||(e.checkExpressionChange(),e.options._markForCheck({fieldGroup:e.fields,model:e.model,formControl:e.form,options:e.options}))}))),this.options.updateInitialValue||(this.options.updateInitialValue=function(){return e.options._initialModel=j(e.model)}),this.options._buildForm||(this.options._buildForm=function(t){void 0===t&&(t=!1),e.clearModelSubscriptions(),e.formlyBuilder.buildForm(e.form,e.fields,e.model,e.options),e.trackModelChanges(e.fields),t&&e.modelChange.emit(e._modelChangeValue=j(e.model))})},e.prototype.checkExpressionChange=function(){this.options&&this.options._checkField&&this.options._checkField({fieldGroup:this.fields,model:this.model,formControl:this.form,options:this.options})},e.prototype.trackModelChanges=function(e,t){var n=this;void 0===t&&(t=[]),e.forEach((function(e){if(e.key&&!e.fieldGroup){var r=e.formControl,o=r.valueChanges.pipe((0,s.distinctUntilChanged)((function(e,t){return e===t&&!Array.isArray(e)&&!P(e)}))),i=e.modelOptions,l=i.updateOn,u=i.debounce;(!l||"change"===l)&&u&&u.default>0&&(o=r.valueChanges.pipe((0,s.debounceTime)(u.default))),n.modelChangeSubs.push(o.subscribe((function(o){r instanceof a.FormControl&&r._fields&&r._fields.length>1&&r.patchValue(o,{emitEvent:!1,onlySelf:!0}),e.parsers&&e.parsers.length>0&&e.parsers.forEach((function(e){return o=e(o)})),n.changeModel({key:(0,p.__spread)(t,v(e)).join("."),value:o,field:e})})));var f=r.valueChanges.observers;f&&f.length>1&&f.unshift(f.pop())}e.fieldGroup&&e.fieldGroup.length>0&&n.trackModelChanges(e.fieldGroup,e.key?(0,p.__spread)(t,v(e)):t)}))},e.prototype.clearModelSubscriptions=function(){this.modelChangeSubs.forEach((function(e){return e.unsubscribe()})),this.modelChangeSubs=[]},Object.defineProperty(e.prototype,"field",{get:function(){return this.fields&&this.fields[0]&&this.fields[0].parent},enumerable:!0,configurable:!0}),e.ctorParameters=function(){return[{type:G},{type:D},{type:o.NgZone},{type:void 0,decorators:[{type:o.Attribute,args:["immutable"]}]},{type:a.FormGroupDirective,decorators:[{type:o.Optional}]}]},e.propDecorators={form:[{type:o.Input}],model:[{type:o.Input}],fields:[{type:o.Input}],options:[{type:o.Input}],modelChange:[{type:o.Output}],content:[{type:o.ViewChild,args:["content"]}]},e.ɵfac=function(t){return new(t||e)(o["ɵɵdirectiveInject"](G),o["ɵɵdirectiveInject"](D),o["ɵɵdirectiveInject"](o.NgZone),o["ɵɵinjectAttribute"]("immutable"),o["ɵɵdirectiveInject"](a.FormGroupDirective,8))},e.ɵcmp=o["ɵɵdefineComponent"]({type:e,selectors:[["formly-form"]],viewQuery:function(e,t){var n;(1&e&&o["ɵɵviewQuery"](u,5),2&e)&&(o["ɵɵqueryRefresh"](n=o["ɵɵloadQuery"]())&&(t.content=n.first))},inputs:{model:"model",fields:"fields",options:"options",form:"form"},outputs:{modelChange:"modelChange"},features:[o["ɵɵProvidersFeature"]([G]),o["ɵɵNgOnChangesFeature"]],ngContentSelectors:c,decls:4,vars:1,consts:[["hide-deprecation","",3,"form","options","model","field",4,"ngFor","ngForOf"],["content",""],["hide-deprecation","",3,"form","options","model","field"]],template:function(e,t){1&e&&(o["ɵɵprojectionDef"](),o["ɵɵtemplate"](0,f,1,4,"formly-field",0),o["ɵɵelementContainerStart"](1,null,1),o["ɵɵprojection"](3),o["ɵɵelementContainerEnd"]()),2&e&&o["ɵɵproperty"]("ngForOf",t.fields)},dependencies:function(){return[r.NgForOf,B]},encapsulation:2}),("undefined"==typeof ngDevMode||ngDevMode)&&o["ɵsetClassMetadata"](e,[{type:o.Component,args:[{selector:"formly-form",template:'\n    <formly-field *ngFor="let field of fields"\n      hide-deprecation\n      [form]="field.form"\n      [options]="field.options"\n      [model]="field.model"\n      [field]="field">\n    </formly-field>\n    <ng-container #content>\n      <ng-content></ng-content>\n    </ng-container>\n  ',providers:[G]}]}],(function(){return[{type:G},{type:D},{type:o.NgZone},{type:void 0,decorators:[{type:o.Attribute,args:["immutable"]}]},{type:a.FormGroupDirective,decorators:[{type:o.Optional}]}]}),{modelChange:[{type:o.Output}],model:[{type:o.Input}],fields:[{type:o.Input}],options:[{type:o.Input}],content:[{type:o.ViewChild,args:["content"]}],form:[{type:o.Input}]}),e}(),B=function(){function e(e,t,n,r,i){this.formlyConfig=e,this.renderer=t,this.resolver=n,this.elementRef=r,this.warnDeprecation=!1,this.modelChange=new o.EventEmitter,this.hostObservers=[],this.componentRefs=[],this.hooksObservers=[],this.warnDeprecation=null===i}return Object.defineProperty(e.prototype,"model",{set:function(e){this.warnDeprecation&&console.warn("NgxFormly: passing 'model' input to '"+this.constructor.name+"' component is not required anymore, you may remove it!")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"form",{set:function(e){this.warnDeprecation&&console.warn("NgxFormly: passing 'form' input to '"+this.constructor.name+"' component is not required anymore, you may remove it!")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{set:function(e){this.warnDeprecation&&console.warn("NgxFormly: passing 'options' input to '"+this.constructor.name+"' component is not required anymore, you may remove it!")},enumerable:!0,configurable:!0}),e.prototype.ngAfterContentInit=function(){this.triggerHook("afterContentInit")},e.prototype.ngAfterContentChecked=function(){this.triggerHook("afterContentChecked")},e.prototype.ngAfterViewInit=function(){this.triggerHook("afterViewInit")},e.prototype.ngAfterViewChecked=function(){this.triggerHook("afterViewChecked")},e.prototype.ngDoCheck=function(){this.triggerHook("doCheck")},e.prototype.ngOnInit=function(){this.triggerHook("onInit")},e.prototype.ngOnChanges=function(e){this.triggerHook("onChanges",e)},e.prototype.ngOnDestroy=function(){this.resetRefs(this.field),this.hostObservers.forEach((function(e){return e()})),this.hooksObservers.forEach((function(e){return e()})),this.triggerHook("onDestroy")},e.prototype.renderField=function(e,t,n){var r=this;if(void 0===n&&(n=[]),this.containerRef===e&&(this.resetRefs(this.field),this.containerRef.clear(),n=this.field?this.field.wrappers:[]),n&&n.length>0){var o=(0,p.__read)(n),i=o[0],s=o.slice(1),a=this.formlyConfig.getWrapper(i).component,l=e.createComponent(this.resolver.resolveComponentFactory(a));this.attachComponentRef(l,t),I(l.instance,"fieldComponent",(function(e){var n=e.firstChange,o=e.previousValue,i=e.currentValue;if(i){var a=o?o.detach():null;a&&!a.destroyed?i.insert(a):r.renderField(i,t,s),!n&&l.changeDetectorRef.detectChanges()}}))}else if(t&&t.type){a=this.formlyConfig.getType(t.type).component;var u=e.createComponent(this.resolver.resolveComponentFactory(a));this.attachComponentRef(u,t)}},e.prototype.triggerHook=function(e,t){if(this.field&&this.field.hooks&&this.field.hooks[e]&&(!t||t.field)){var n=this.field.hooks[e](this.field);if((0,l.isObservable)(n)&&-1!==["onInit","afterContentInit","afterViewInit"].indexOf(e)){var r=n.subscribe();this.hooksObservers.push((function(){return r.unsubscribe()}))}}this.field&&this.field.lifecycle&&this.field.lifecycle[e]&&this.field.lifecycle[e](this.field.form,this.field,this.field.model,this.field.options),"onChanges"===e&&t.field&&(this.resetRefs(t.field.previousValue),this.render())},e.prototype.attachComponentRef=function(e,t){this.componentRefs.push(e),t._componentRefs.push(e),Object.assign(e.instance,{field:t})},e.prototype.render=function(){var e=this;this.field&&(this.hostObservers.forEach((function(e){return e()})),this.hostObservers=[I(this.field,"hide",(function(t){var n=t.firstChange,r=t.currentValue;e.formlyConfig.extras.lazyRender?r?e.containerRef.clear():e.renderField(e.containerRef,e.field):(n&&e.renderField(e.containerRef,e.field),(!n||n&&r)&&e.renderer.setStyle(e.elementRef.nativeElement,"display",r?"none":""))})),I(this.field,"className",(function(t){var n=t.firstChange,r=t.currentValue;(!n||n&&r)&&e.renderer.setAttribute(e.elementRef.nativeElement,"class",r)}))])},e.prototype.resetRefs=function(e){var t=this;e&&(e._componentRefs?e._componentRefs=e._componentRefs.filter((function(e){return-1===t.componentRefs.indexOf(e)})):R(this.field,"_componentRefs",[])),this.componentRefs=[]},e.ctorParameters=function(){return[{type:D},{type:o.Renderer2},{type:o.ComponentFactoryResolver},{type:o.ElementRef},{type:void 0,decorators:[{type:o.Attribute,args:["hide-deprecation"]}]}]},e.propDecorators={field:[{type:o.Input}],model:[{type:o.Input}],form:[{type:o.Input}],options:[{type:o.Input}],modelChange:[{type:o.Output}],containerRef:[{type:o.ViewChild,args:["container",{read:o.ViewContainerRef,static:!0}]}]},e.ɵfac=function(t){return new(t||e)(o["ɵɵdirectiveInject"](D),o["ɵɵdirectiveInject"](o.Renderer2),o["ɵɵdirectiveInject"](o.ComponentFactoryResolver),o["ɵɵdirectiveInject"](o.ElementRef),o["ɵɵinjectAttribute"]("hide-deprecation"))},e.ɵcmp=o["ɵɵdefineComponent"]({type:e,selectors:[["formly-field"]],viewQuery:function(e,t){var n;(1&e&&o["ɵɵviewQuery"](d,7,o.ViewContainerRef),2&e)&&(o["ɵɵqueryRefresh"](n=o["ɵɵloadQuery"]())&&(t.containerRef=n.first))},inputs:{model:"model",form:"form",options:"options",field:"field"},outputs:{modelChange:"modelChange"},features:[o["ɵɵNgOnChangesFeature"]],decls:2,vars:0,consts:[["container",""]],template:function(e,t){1&e&&o["ɵɵtemplate"](0,h,0,0,"ng-template",null,0,o["ɵɵtemplateRefExtractor"])},encapsulation:2}),("undefined"==typeof ngDevMode||ngDevMode)&&o["ɵsetClassMetadata"](e,[{type:o.Component,args:[{selector:"formly-field",template:"<ng-template #container></ng-template>"}]}],(function(){return[{type:D},{type:o.Renderer2},{type:o.ComponentFactoryResolver},{type:o.ElementRef},{type:void 0,decorators:[{type:o.Attribute,args:["hide-deprecation"]}]}]}),{modelChange:[{type:o.Output}],model:[{type:o.Input}],form:[{type:o.Input}],options:[{type:o.Input}],field:[{type:o.Input}],containerRef:[{type:o.ViewChild,args:["container",{read:o.ViewContainerRef,static:!0}]}]}),e}(),L=function(){function e(e,t,n){this.renderer=e,this.elementRef=t,this.uiAttributesCache={},this.uiAttributes=(0,p.__spread)(b,["tabindex","placeholder","readonly","disabled","step"]),this.uiEvents={listeners:[],events:["click","keyup","keydown","keypress"]},this.document=n}return Object.defineProperty(e.prototype,"to",{get:function(){return this.field.templateOptions||{}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fieldAttrElements",{get:function(){return this.field&&this.field._elementRefs||[]},enumerable:!0,configurable:!0}),e.prototype.ngOnChanges=function(e){var t=this;e.field&&(this.field.name&&this.setAttribute("name",this.field.name),this.uiEvents.listeners.forEach((function(e){return e()})),this.uiEvents.events.forEach((function(e){t.to&&t.to[e]&&t.uiEvents.listeners.push(t.renderer.listen(t.elementRef.nativeElement,e,(function(n){return t.to[e](t.field,n)})))})),this.to&&this.to.attributes&&I(this.to,"attributes",(function(e){var n=e.currentValue,r=e.previousValue;r&&Object.keys(r).forEach((function(e){return t.removeAttribute(e)})),n&&Object.keys(n).forEach((function(e){return t.setAttribute(e,n[e])}))})),this.detachElementRef(e.field.previousValue),this.attachElementRef(e.field.currentValue),1===this.fieldAttrElements.length&&(!this.id&&this.field.id&&this.setAttribute("id",this.field.id),I(this.field,"focus",(function(e){var n=e.currentValue;t.toggleFocus(n)})))),e.id&&this.setAttribute("id",this.id)},e.prototype.ngDoCheck=function(){var e=this;this.uiAttributes.forEach((function(t){var n=e.to[t];e.uiAttributesCache[t]!==n&&(e.uiAttributesCache[t]=n,n||0===n?e.setAttribute(t,!0===n?t:""+n):e.removeAttribute(t))}))},e.prototype.ngOnDestroy=function(){this.uiEvents.listeners.forEach((function(e){return e()})),this.detachElementRef(this.field)},e.prototype.toggleFocus=function(e){var t=this,n=this.fieldAttrElements?this.fieldAttrElements[0]:null;if(n&&n.nativeElement.focus){var r=!!this.document.activeElement&&this.fieldAttrElements.some((function(e){var n=e.nativeElement;return t.document.activeElement===n||n.contains(t.document.activeElement)}));e&&!r?n.nativeElement.focus():!e&&r&&n.nativeElement.blur()}},e.prototype.onFocus=function(e){this.field.___$focus=!0,this.to.focus&&this.to.focus(this.field,e)},e.prototype.onBlur=function(e){this.field.___$focus=!1,this.to.blur&&this.to.blur(this.field,e)},e.prototype.onChange=function(e){this.to.change&&this.to.change(this.field,e),this.field.formControl&&this.field.formControl.markAsDirty()},e.prototype.attachElementRef=function(e){e&&(e._elementRefs&&-1===e._elementRefs.indexOf(this.elementRef)?e._elementRefs.push(this.elementRef):R(e,"_elementRefs",[this.elementRef]))},e.prototype.detachElementRef=function(e){var t=e&&e._elementRefs?this.fieldAttrElements.indexOf(this.elementRef):-1;-1!==t&&this.field._elementRefs.splice(t,1)},e.prototype.setAttribute=function(e,t){this.renderer.setAttribute(this.elementRef.nativeElement,e,t)},e.prototype.removeAttribute=function(e){this.renderer.removeAttribute(this.elementRef.nativeElement,e)},e.ctorParameters=function(){return[{type:o.Renderer2},{type:o.ElementRef},{type:void 0,decorators:[{type:o.Inject,args:[r.DOCUMENT]}]}]},e.propDecorators={field:[{type:o.Input,args:["formlyAttributes"]}],id:[{type:o.Input}]},e.ɵfac=function(t){return new(t||e)(o["ɵɵdirectiveInject"](o.Renderer2),o["ɵɵdirectiveInject"](o.ElementRef),o["ɵɵdirectiveInject"](r.DOCUMENT))},e.ɵdir=o["ɵɵdefineDirective"]({type:e,selectors:[["","formlyAttributes",""]],hostBindings:function(e,t){1&e&&o["ɵɵlistener"]("focus",(function(e){return t.onFocus(e)}))("blur",(function(e){return t.onBlur(e)}))("change",(function(e){return t.onChange(e)}))},inputs:{field:["formlyAttributes","field"],id:"id"},features:[o["ɵɵNgOnChangesFeature"]]}),("undefined"==typeof ngDevMode||ngDevMode)&&o["ɵsetClassMetadata"](e,[{type:o.Directive,args:[{selector:"[formlyAttributes]",host:{"(focus)":"onFocus($event)","(blur)":"onBlur($event)","(change)":"onChange($event)"}}]}],(function(){return[{type:o.Renderer2},{type:o.ElementRef},{type:void 0,decorators:[{type:o.Inject,args:[r.DOCUMENT]}]}]}),{field:[{type:o.Input,args:["formlyAttributes"]}],id:[{type:o.Input}]}),e}(),Q=function(){function e(){}return Object.defineProperty(e.prototype,"model",{get:function(){return this.field.model},set:function(e){console.warn("NgxFormly: passing 'model' input to '"+this.constructor.name+"' component is not required anymore, you may remove it!")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"form",{get:function(){return this.field.parent.formControl},set:function(e){console.warn("NgxFormly: passing 'form' input to '"+this.constructor.name+"' component is not required anymore, you may remove it!")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.field.options},set:function(e){console.warn("NgxFormly: passing 'options' input to '"+this.constructor.name+"' component is not required anymore, you may remove it!")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this.field.key},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formControl",{get:function(){return this.field.formControl},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"to",{get:function(){return this.field.templateOptions||{}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showError",{get:function(){return this.options.showError(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.field.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formState",{get:function(){return this.options.formState||{}},enumerable:!0,configurable:!0}),e.propDecorators={field:[{type:o.Input}],model:[{type:o.Input}],form:[{type:o.Input}],options:[{type:o.Input}]},e.ɵfac=function(t){return new(t||e)},e.ɵdir=o["ɵɵdefineDirective"]({type:e,inputs:{model:"model",form:"form",options:"options",field:"field"}}),e}(),z=function(e){function t(){var t=e.call(this)||this;return console.warn("NgxFormly: 'Field' has been renamed to 'FieldType', extend 'FieldType' instead."),t}return(0,p.__extends)(t,e),t}(Q),Z=function(e){function t(t){var n=e.call(this)||this;return n.defaultOptions={defaultValue:[]},t instanceof G&&console.warn("NgxFormly: passing 'FormlyFormBuilder' to '"+n.constructor.name+"' type is not required anymore, you may remove it!"),n}return(0,p.__extends)(t,e),Object.defineProperty(t.prototype,"formControl",{get:function(){return this.field.formControl},enumerable:!0,configurable:!0}),t.prototype.onPopulate=function(e){if(!e.formControl&&e.key){var t=T(e);S(e,t||new a.FormArray([],{updateOn:e.modelOptions.updateOn}))}e.fieldGroup=e.fieldGroup||[];var n=e.model?e.model.length:0;if(e.fieldGroup.length>n)for(var r=e.fieldGroup.length-1;r>=n;--r)N(e.fieldGroup[r]),e.fieldGroup.splice(r,1);for(r=e.fieldGroup.length;r<n;r++){var o=(0,p.__assign)({},j(e.fieldArray),{key:""+r});e.fieldGroup.push(o)}},t.prototype.add=function(e,t,n){var r=(void 0===n?{markAsDirty:!0}:n).markAsDirty;e=E(e)?this.field.fieldGroup.length:e,this.model||C(this.field,[]),this.model.splice(e,0,t?j(t):void 0),this.options._buildForm(!0),r&&this.formControl.markAsDirty()},t.prototype.remove=function(e,t){var n=(void 0===t?{markAsDirty:!0}:t).markAsDirty;this.model.splice(e,1),N(this.field.fieldGroup[e],!0),this.field.fieldGroup.splice(e,1),this.field.fieldGroup.forEach((function(e,t){return e.key=""+t})),this.options._buildForm(!0),n&&this.formControl.markAsDirty()},t.ctorParameters=function(){return[{type:G,decorators:[{type:o.Inject,args:[A]},{type:o.Optional}]}]},t.ɵfac=function(e){return new(e||t)(o["ɵɵdirectiveInject"](A,8))},t.ɵdir=o["ɵɵdefineDirective"]({type:t,selectors:[["fieldArray"]],features:[o["ɵɵInheritDefinitionFeature"]]}),("undefined"==typeof ngDevMode||ngDevMode)&&o["ɵsetClassMetadata"](t,[{type:o.Directive,args:[{selector:"[ɵfieldArray]"}]}],(function(){return[{type:G,decorators:[{type:o.Inject,args:[A]},{type:o.Optional}]}]}),null),t}(Q),Y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,p.__extends)(t,e),t.propDecorators={fieldComponent:[{type:o.ViewChild,args:["fieldComponent",{read:o.ViewContainerRef,static:!1}]}]},t.ɵfac=function(){var e;return function(n){return(e||(e=o["ɵɵgetInheritedFactory"](t)))(n||t)}}(),t.ɵdir=o["ɵɵdefineDirective"]({type:t,viewQuery:function(e,t){var n;(1&e&&o["ɵɵviewQuery"](m,5,o.ViewContainerRef),2&e)&&(o["ɵɵqueryRefresh"](n=o["ɵɵloadQuery"]())&&(t.fieldComponent=n.first))},features:[o["ɵɵInheritDefinitionFeature"]]}),t}(Q),J=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.defaultOptions={defaultValue:{}},t}return(0,p.__extends)(t,e),t.ɵfac=function(){var e;return function(n){return(e||(e=o["ɵɵgetInheritedFactory"](t)))(n||t)}}(),t.ɵcmp=o["ɵɵdefineComponent"]({type:t,selectors:[["formly-group"]],hostVars:2,hostBindings:function(e,t){2&e&&o["ɵɵclassMap"](t.field.fieldGroupClassName||"")},features:[o["ɵɵInheritDefinitionFeature"]],ngContentSelectors:c,decls:2,vars:1,consts:[[3,"field",4,"ngFor","ngForOf"],[3,"field"]],template:function(e,t){1&e&&(o["ɵɵprojectionDef"](),o["ɵɵtemplate"](0,y,1,1,"formly-field",0),o["ɵɵprojection"](1)),2&e&&o["ɵɵproperty"]("ngForOf",t.field.fieldGroup)},dependencies:[r.NgForOf,B],encapsulation:2}),("undefined"==typeof ngDevMode||ngDevMode)&&o["ɵsetClassMetadata"](t,[{type:o.Component,args:[{selector:"formly-group",template:'\n    <formly-field *ngFor="let f of field.fieldGroup" [field]="f"></formly-field>\n    <ng-content></ng-content>\n  ',host:{"[class]":'field.fieldGroupClassName || ""'}}]}],null,null),t}(Q),U=function(){function e(e){this.formlyConfig=e}return e.prototype.ngOnChanges=function(){var e=this;this.errorMessage$=this.field.formControl.statusChanges.pipe((0,s.startWith)(null),(0,s.switchMap)((function(){return(0,l.isObservable)(e.errorMessage)?e.errorMessage:(0,l.of)(e.errorMessage)})))},Object.defineProperty(e.prototype,"errorMessage",{get:function(){var e=this.field.formControl;for(var t in e.errors)if(e.errors.hasOwnProperty(t)){var n=this.formlyConfig.getValidatorMessage(t);if(P(e.errors[t])){if(e.errors[t].errorPath)return;e.errors[t].message&&(n=e.errors[t].message)}return this.field.validation&&this.field.validation.messages&&this.field.validation.messages[t]&&(n=this.field.validation.messages[t]),this.field.validators&&this.field.validators[t]&&this.field.validators[t].message&&(n=this.field.validators[t].message),this.field.asyncValidators&&this.field.asyncValidators[t]&&this.field.asyncValidators[t].message&&(n=this.field.asyncValidators[t].message),"function"==typeof n?n(e.errors[t],this.field):n}},enumerable:!0,configurable:!0}),e.ctorParameters=function(){return[{type:D}]},e.propDecorators={field:[{type:o.Input}]},e.ɵfac=function(t){return new(t||e)(o["ɵɵdirectiveInject"](D))},e.ɵcmp=o["ɵɵdefineComponent"]({type:e,selectors:[["formly-validation-message"]],inputs:{field:"field"},features:[o["ɵɵNgOnChangesFeature"]],decls:2,vars:3,template:function(e,t){1&e&&(o["ɵɵtext"](0),o["ɵɵpipe"](1,"async")),2&e&&o["ɵɵtextInterpolate"](o["ɵɵpipeBind1"](1,1,t.errorMessage$))},dependencies:[r.AsyncPipe],encapsulation:2,changeDetection:0}),("undefined"==typeof ngDevMode||ngDevMode)&&o["ɵsetClassMetadata"](e,[{type:o.Component,args:[{selector:"formly-validation-message",template:"{{ errorMessage$ | async }}",changeDetection:o.ChangeDetectionStrategy.OnPush}]}],(function(){return[{type:D}]}),{field:[{type:o.Input}]}),e}(),K=function(e){function t(t){var n=e.call(this)||this;return n.sanitizer=t,n.innerHtml={content:null,template:null},n}return(0,p.__extends)(t,e),Object.defineProperty(t.prototype,"template",{get:function(){return this.field&&this.field.template!==this.innerHtml.template&&(this.innerHtml={template:this.field.template,content:this.to.safeHtml?this.sanitizer.bypassSecurityTrustHtml(this.field.template):this.field.template}),this.innerHtml.content},enumerable:!0,configurable:!0}),t.ctorParameters=function(){return[{type:i.DomSanitizer}]},t.ɵfac=function(e){return new(e||t)(o["ɵɵdirectiveInject"](i.DomSanitizer))},t.ɵcmp=o["ɵɵdefineComponent"]({type:t,selectors:[["formly-template"]],features:[o["ɵɵInheritDefinitionFeature"]],decls:1,vars:1,consts:[[3,"innerHtml"]],template:function(e,t){1&e&&o["ɵɵelement"](0,"div",0),2&e&&o["ɵɵproperty"]("innerHtml",t.template,o["ɵɵsanitizeHtml"])},encapsulation:2}),("undefined"==typeof ngDevMode||ngDevMode)&&o["ɵsetClassMetadata"](t,[{type:o.Component,args:[{selector:"formly-template",template:'<div [innerHtml]="template"></div>'}]}],(function(){return[{type:i.DomSanitizer}]}),null),t}(Q);function X(e,t,n){return e instanceof Function?e.apply(t,n):!!e}var ee=function(){function e(){}return e.prototype.prePopulate=function(e){var t=this;if(!e.parent&&!e.options._checkField){var n=!1;e.options._checkField=function(e,r){n||(n=!0,M(e.formControl,(function(){return t.checkField(e,r)})),n=!1)}}},e.prototype.postPopulate=function(e){var t=this;if(e.parent&&!e._expressionProperties){if(R(e,"_expressionProperties",{}),e.expressionProperties){var n=function(n){var o=e.expressionProperties[n];if("string"==typeof o||w(o))e._expressionProperties[n]={expression:r._evalExpression(n,o,"templateOptions.disabled"===n&&e.parent.expressionProperties&&e.parent.expressionProperties.hasOwnProperty("templateOptions.disabled")?function(){return e.parent.templateOptions.disabled}:void 0)},"templateOptions.disabled"===n&&Object.defineProperty(e._expressionProperties[n],"expressionValue",{get:function(){return e.templateOptions.disabled},set:function(){},enumerable:!0,configurable:!0});else if(o instanceof l.Observable){var i=function(){return o.subscribe((function(r){t.setExprValue(e,n,r),e.options&&e.options._markForCheck&&e.options._markForCheck(e)}))},s=i(),a=e.hooks.onInit;e.hooks.onInit=function(){return null===s&&(s=i()),a&&a(e)};var p=e.hooks.onDestroy;e.hooks.onDestroy=function(){p&&p(e),s.unsubscribe(),s=null}}},r=this;for(var o in e.expressionProperties)n(o)}e.hideExpression?(delete e.hide,e.hideExpression=this._evalExpression("hide",e.hideExpression,(function(){for(var t=e.parent;t.parent&&!t.hide;)t=t.parent;return t.hide}))):I(e,"hide",(function(t){var n=t.currentValue,r=t.firstChange;e._hide=n,(!r||r&&!0===n)&&e.options._hiddenFieldsForCheck.push(e)}))}},e.prototype._evalExpression=function(e,t,n){return function(r,o,i){try{return"string"==typeof t&&(t=function(e,t){try{return-1!==e.indexOf("this.field")&&console.warn("NgxFormly: using 'this.field' in expressionProperties is deprecated since v5.1, use 'field' instead."),Function.apply(void 0,(0,p.__spread)(t,["return "+e+";"]))}catch(e){console.error(e)}}(t,["model","formState","field"])),"function"!=typeof t&&(t=function(){return!!t}),n&&n()||t(r,o,i)}catch(t){throw t.message='[Formly Error] [Expression "'+e+'"] '+t.message,t}}},e.prototype.checkField=function(e,t){var n=this;void 0===t&&(t=!1),this._checkField(e,t),e.options._hiddenFieldsForCheck.sort((function(e){return e.hide?-1:1})).forEach((function(e){return n.toggleFormControl(e,!!e.hide,!t)})),e.options._hiddenFieldsForCheck=[]},e.prototype._checkField=function(e,t){var n=this;void 0===t&&(t=!1);var r=!1;e.fieldGroup.forEach((function(o){n.checkFieldExpressionChange(o,t)&&(r=!0),n.checkFieldVisibilityChange(o,t)&&(e.options._hiddenFieldsForCheck.push(o),r=!0),o.fieldGroup&&o.fieldGroup.length>0&&n._checkField(o,t)})),r&&e.options&&e.options._markForCheck&&e.options._markForCheck(e)},e.prototype.checkFieldExpressionChange=function(e,t){if(!e||!e._expressionProperties)return!1;var n=!1,r=e._expressionProperties;for(var o in r){var i=X(r[o].expression,{field:e},[e.model,e.options.formState,e]);"templateOptions.disabled"===o&&(i=!!i),!t&&(r[o].expressionValue===i||P(i)&&JSON.stringify(i)===JSON.stringify(r[o].expressionValue))||(n=!0,r[o].expressionValue=i,this.setExprValue(e,o,i))}return n},e.prototype.checkFieldVisibilityChange=function(e,t){if(!e||E(e.hideExpression))return!1;var n=!!X(e.hideExpression,{field:e},[e.model,e.options.formState,e]),r=!1;return(n!==e.hide||t)&&(r=!0,e.hide=n,e.templateOptions.hidden=n),r},e.prototype.setDisabledState=function(e,t){var n=this;e.fieldGroup&&e.fieldGroup.filter((function(e){return!e.expressionProperties||!e.expressionProperties.hasOwnProperty("templateOptions.disabled")})).forEach((function(e){return n.setDisabledState(e,t)})),e.key&&e.templateOptions.disabled!==t&&(e.templateOptions.disabled=t)},e.prototype.toggleFormControl=function(e,t,n){var r=this;if(e.formControl&&e.key){R(e,"_hide",!(!t&&!e.hide));var o=e.formControl;o._fields.length>1&&H(o),!0===t&&o._fields.every((function(e){return!!e._hide}))?(N(e,!0),n&&e.resetOnHide&&(e.formControl.reset({value:void 0,disabled:e.formControl.disabled}),e.fieldGroup&&(C(e,void 0),e.formControl instanceof a.FormArray&&(e.fieldGroup.length=0)))):!1===t&&(e.resetOnHide&&e.parent&&!k(e.defaultValue)&&k(F(e))&&C(e,e.defaultValue),S(e,void 0,!0),e.resetOnHide&&e.fieldArray&&(e.fieldGroup||[]).length!==(e.model||[]).length&&e.options._buildForm(!0))}e.fieldGroup&&e.fieldGroup.filter((function(e){return!e.hideExpression})).forEach((function(e){return r.toggleFormControl(e,t,n)})),e.options.fieldChanges&&e.options.fieldChanges.next({field:e,type:"hidden",value:t})},e.prototype.setExprValue=function(e,t,n){try{for(var r=e,o=(-1===t.indexOf("[")?t:t.replace(/\[(\w+)\]/g,".$1")).split("."),i=o.length-1,s=0;s<i;s++)r=r[o[s]];r[o[i]]=n}catch(e){throw e.message='[Formly Error] [Expression "'+t+'"] '+e.message,e}if("templateOptions.disabled"===t&&e.key&&this.setDisabledState(e,n),0===t.indexOf("model.")){var a=t.replace(/^model\./,""),l=e.key&&t===a?e.formControl:e.parent.formControl.get(a);!l||E(l.value)&&E(n)||l.value===n||l.patchValue(n,{emitEvent:!1})}this.emitExpressionChanges(e,t,n)},e.prototype.emitExpressionChanges=function(e,t,n){e.options.fieldChanges&&e.options.fieldChanges.next({field:e,type:"expressionChanges",property:t,value:n})},e}(),te=function(){function e(e){this.formlyConfig=e}return e.prototype.onPopulate=function(e){this.initFieldValidation(e,"validators"),this.initFieldValidation(e,"asyncValidators")},e.prototype.initFieldValidation=function(e,t){var n=this,r=[];if("validators"!==t||e.hasOwnProperty("fieldGroup")&&!e.key||r.push(this.getPredefinedFieldValidation(e)),e[t])for(var o in e[t])"validation"!==o||Array.isArray(e[t].validation)||(e[t].validation=[e[t].validation],console.warn("NgxFormly("+e.key+"): passing a non array value to the 'validation' is deprecated, pass an array instead")),"validation"===o?r.push.apply(r,(0,p.__spread)(e[t].validation.map((function(t){return n.wrapNgValidatorFn(e,t)})))):r.push(this.wrapNgValidatorFn(e,e[t][o],o));R(e,"_"+t,r)},e.prototype.getPredefinedFieldValidation=function(e){var t=[];return b.forEach((function(n){return I(e.templateOptions,n,(function(r){var o=r.currentValue,i=r.firstChange;t=t.filter((function(e){return e!==n})),null!=o&&!1!==o&&t.push(n),!i&&e.formControl&&H(e.formControl)}))})),function(n){return 0===t.length?null:a.Validators.compose(t.map((function(t){return function(){var r=e.templateOptions[t];switch(t){case"required":return a.Validators.required(n);case"pattern":return a.Validators.pattern(r)(n);case"minLength":return a.Validators.minLength(r)(n);case"maxLength":return a.Validators.maxLength(r)(n);case"min":return a.Validators.min(r)(n);case"max":return a.Validators.max(r)(n)}}})))(n)}},e.prototype.wrapNgValidatorFn=function(e,t,n){var r=this,o=null;if("string"==typeof t&&(o=j(this.formlyConfig.getValidator(t))),"object"==typeof t&&t.name&&(o=j(this.formlyConfig.getValidator(t.name)),t.options&&(o.options=t.options)),"object"==typeof t&&t.expression){var i=t.expression,a=(0,p.__rest)(t,["expression"]);o={name:n,validation:i,options:Object.keys(a).length>0?a:null}}return"function"==typeof t&&(o={name:n,validation:t}),function(t){var i,a=o.validation(t,e,o.options);return(i=a)&&"function"==typeof i.then?a.then((function(t){return r.handleAsyncResult(e,n?!!t:t,o)})):(0,l.isObservable)(a)?a.pipe((0,s.map)((function(t){return r.handleAsyncResult(e,n?!!t:t,o)}))):r.handleResult(e,n?!!a:a,o)}},e.prototype.handleAsyncResult=function(e,t,n){return e.options&&e.options._markForCheck&&e.options._markForCheck(e),this.handleResult(e,t,n)},e.prototype.handleResult=function(e,t,n){var r,o=n.name,i=n.options;"boolean"==typeof t&&(t=t?null:((r={})[o]=i||!0,r));var s=e.formControl;return s._childrenErrors&&s._childrenErrors[o]&&s._childrenErrors[o](),P(t)&&Object.keys(t).forEach((function(n){var r,o=t[n].errorPath?t[n].errorPath:(i||{}).errorPath,a=o?e.formControl.get(o):null;if(a){var l=t[n],u=(l.errorPath,(0,p.__rest)(l,["errorPath"]));a.setErrors((0,p.__assign)({},a.errors||{},((r={})[n]=u,r))),!s._childrenErrors&&R(s,"_childrenErrors",{}),s._childrenErrors[n]=function(){var e=a.errors||{},t=n,r=(e[t],(0,p.__rest)(e,["symbol"==typeof t?t:t+""]));a.setErrors(0===Object.keys(r).length?null:r)}}})),t},e}(),ne=function(){function e(e){this.config=e}return e.prototype.onPopulate=function(e){e.parent&&(e.fieldGroup&&!e.key?R(e,"formControl",e.parent.formControl):this.addFormControl(e))},e.prototype.postPopulate=function(e){if(!e.parent){var t=this.setValidators(e);0!==t.length&&(1===t.length?t[0].formControl.updateValueAndValidity():e.formControl._updateTreeValidity())}},e.prototype.addFormControl=function(e){var t=T(e);if(!t){var n={updateOn:e.modelOptions.updateOn},r=e.key?F(e):e.defaultValue,o=this.config?this.config.resolveFieldTypeRef(e):null;if(o&&o.componentType&&o.componentType.createControl){var i=o.componentType;console.warn("NgxFormly: '"+i.name+"::createControl' is deprecated since v5.0, use 'prePopulate' hook instead."),t=i.createControl(r,e)}else t=e.fieldGroup?new a.FormGroup({},n):new a.FormControl(r,n)}S(e,t)},e.prototype.setValidators=function(e){var t=this,n=!1;if(e.key||!e.parent||!e.key&&!e.fieldGroup){var r=e.formControl;!!e.templateOptions&&e.templateOptions.disabled&&r.enabled&&(r.disable({emitEvent:!1,onlySelf:!0}),r.parent?n=!0:H(r)),null!==r.validator&&null!==r.asyncValidator||(r.setValidators((function(){var n=a.Validators.compose(t.mergeValidators(e,"_validators"));return n?n(r):null})),r.setAsyncValidators((function(){var n=a.Validators.composeAsync(t.mergeValidators(e,"_asyncValidators"));return n?n(r):(0,l.of)(null)})),r.parent?n=!0:H(r))}var o=n?[e]:[];return(e.fieldGroup||[]).forEach((function(e){var r=t.setValidators(e);n||o.push.apply(o,(0,p.__spread)(r))})),o},e.prototype.mergeValidators=function(e,t){var n=this,r=[],o=e.formControl;return o&&o._fields&&o._fields.length>1?o._fields.filter((function(e){return!e._hide})).forEach((function(e){return r.push.apply(r,(0,p.__spread)(e[t]))})):r.push.apply(r,(0,p.__spread)(e[t])),e.fieldGroup&&e.fieldGroup.filter((function(e){return!e.key&&e.fieldGroup})).forEach((function(e){return r.push.apply(r,(0,p.__spread)(n.mergeValidators(e,t)))})),r},e}(),re=function(){function e(e){this.formlyConfig=e,this.formId=0}return e.prototype.prePopulate=function(e){if(this.getFieldComponentInstance(e).prePopulate(),!e.parent){var t=e.options&&e.options.fieldTransform||this.formlyConfig.extras.fieldTransform;(Array.isArray(t)?t:[t]).forEach((function(t){if(t&&(console.warn("NgxFormly: fieldTransform is deprecated since v5.0, use custom extension instead."),!t(e.fieldGroup,e.model,e.formControl,e.options)))throw new Error("fieldTransform must return an array of fields")}))}},e.prototype.onPopulate=function(e){var t=this;this.initFieldOptions(e),this.getFieldComponentInstance(e).onPopulate(),e.fieldGroup&&e.fieldGroup.forEach((function(n,r){Object.defineProperty(n,"parent",{get:function(){return e},configurable:!0}),Object.defineProperty(n,"index",{get:function(){return r},configurable:!0}),t.formId++}))},e.prototype.postPopulate=function(e){this.getFieldComponentInstance(e).postPopulate()},e.prototype.initFieldOptions=function(e){var t=e.parent;if(t){if(Object.defineProperty(e,"form",{get:function(){return t.formControl},configurable:!0}),Object.defineProperty(e,"options",{get:function(){return t.options},configurable:!0}),Object.defineProperty(e,"model",{get:function(){return e.key&&e.fieldGroup?F(e):t.model},configurable:!0}),O(e,{id:g("formly_"+this.formId,e,e.index),hooks:{},modelOptions:{},templateOptions:e.type&&e.key?{label:"",placeholder:"",focus:!1,disabled:!1}:{}}),this.formlyConfig.extras.resetFieldOnHide&&!1!==e.resetOnHide&&(e.resetOnHide=!0),e.lifecycle&&console.warn("NgxFormly: 'lifecycle' is deprecated since v5.0, use 'hooks' instead."),"formly-template"!==e.type&&(e.template||e.expressionProperties&&e.expressionProperties.template)&&(e.type&&console.warn("NgxFormly: passing 'type' property is not allowed when 'template' is set."),e.type="formly-template"),!e.type&&e.fieldGroup&&(e.type="formly-group"),e.type&&this.formlyConfig.getMergedField(e),e.parent){var n=!k(e.key)&&!k(e.defaultValue)&&k(F(e))&&(!e.resetOnHide||!(e.hide||e.hideExpression));if(n&&e.resetOnHide){for(var r=e.parent;r&&!r.hideExpression&&!r.hide;)r=r.parent;n=!r||!(r.hideExpression||r.hide)}n&&C(e,e.defaultValue)}this.initFieldWrappers(e)}},e.prototype.initFieldWrappers=function(e){e.wrappers=e.wrappers||[];var t=(0,p.__assign)({preWrapper:[],postWrapper:[]},e.templateOptions.templateManipulators||{});e.wrappers=(0,p.__spread)(this.formlyConfig.templateManipulators.preWrapper.map((function(t){return t(e)})),t.preWrapper.map((function(t){return t(e)})),e.wrappers,this.formlyConfig.templateManipulators.postWrapper.map((function(t){return t(e)})),t.postWrapper.map((function(t){return t(e)}))).filter((function(e,t,n){return e&&t===n.indexOf(e)}))},e.prototype.getFieldComponentInstance=function(e){var t=this.formlyConfig.resolveFieldTypeRef(e),n=t?t.instance:{};return{prePopulate:function(){return n.prePopulate&&n.prePopulate(e)},onPopulate:function(){return n.onPopulate&&n.onPopulate(e)},postPopulate:function(){return n.postPopulate&&n.postPopulate(e)}}},e}();function oe(e){return{types:[{name:"formly-group",component:J},{name:"formly-template",component:K}],extensions:[{name:"core",extension:new re(e)},{name:"field-validation",extension:new te(e)},{name:"field-form",extension:new ne(e)},{name:"field-expression",extension:new ee}]}}var ie=function(){function e(e,t){void 0===t&&(t=[]),t&&t.forEach((function(t){return e.addConfig(t)}))}return e.forRoot=function(t){return void 0===t&&(t={}),{ngModule:e,providers:[{provide:A,multi:!0,useFactory:oe,deps:[D]},{provide:A,useValue:t,multi:!0},{provide:o.ANALYZE_FOR_ENTRY_COMPONENTS,useValue:t,multi:!0},D,G]}},e.forChild=function(t){return void 0===t&&(t={}),{ngModule:e,providers:[{provide:A,multi:!0,useFactory:oe,deps:[D]},{provide:A,useValue:t,multi:!0},{provide:o.ANALYZE_FOR_ENTRY_COMPONENTS,useValue:t,multi:!0},G]}},e.ctorParameters=function(){return[{type:D},{type:Array,decorators:[{type:o.Optional},{type:o.Inject,args:[A]}]}]},e.ɵfac=function(t){return new(t||e)(o["ɵɵinject"](D),o["ɵɵinject"](A,8))},e.ɵmod=o["ɵɵdefineNgModule"]({type:e}),e.ɵinj=o["ɵɵdefineInjector"]({imports:[r.CommonModule]}),("undefined"==typeof ngDevMode||ngDevMode)&&o["ɵsetClassMetadata"](e,[{type:o.NgModule,args:[{declarations:[q,B,L,J,U,K,Z],entryComponents:[J,K],exports:[q,B,L,J,U],imports:[r.CommonModule]}]}],(function(){return[{type:D},{type:Array,decorators:[{type:o.Optional},{type:o.Inject,args:[A]}]}]}),null),("undefined"==typeof ngJitMode||ngJitMode)&&o["ɵɵsetNgModuleScope"](e,{declarations:function(){return[q,B,L,J,U,K,Z]},imports:function(){return[r.CommonModule]},exports:function(){return[q,B,L,J,U]}}),e}()}}]);